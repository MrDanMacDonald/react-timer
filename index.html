<html>
  <head>
    <title>Nav-Bar</title>
    <link type="text/css" rel="stylesheet" href="styles.css"/>
    <script src="http://fb.me/react-0.12.2.js"></script>
    <script src="http://fb.me/JSXTransformer-0.12.2.js"></script>
    <script type="text/javascript" src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
  </head>
  <body>
    <div id="content"></div>
    <script type="text/jsx">
      var NavBar = React.createClass({
        propTypes: {
          navItems: React.PropTypes.array.isRequired,
          item: React.PropTypes.string
        },
        getDefaultProps: function () {
          return {
            item: ''
          };
        },
        // handleClicked: function (i) {
        //   console.log('CLicked!')
        //   this.setState({focused: i});
        // },
        // renderNavItems: function () {
        //   console.log('this.props: ', this.props)
        //   var style = '';
        //   var self = this;
        //   return this.props.navItems.map(function(item, i) {
        //     if(this.state.focused == i){
        //       style = 'focused';
        //     };
        //     return <li
        //       className={style}
        //       key={'item-' + i}
        //       index={i}
        //       onClick={self.handleClicked.bind(self, i)}>{item}</li>
        //   }.bind(this));
        // },
        renderNavItems: function() {
          return this.props.navItems.map(function(item, i) {
            return (
              <li>
                <NavBarItem
                item={item}
                index={i} />
              </li>
            );
          }.bind(this));
        },
        render: function () {
          return (
            <ul>
              {this.renderNavItems()}
            </ul> 
          );
        }
      });

    var NavBarItem = React.createClass({
      propTypes: {
        item: React.PropTypes.string.isRequired,
        index: React.PropTypes.number.isRequired,
        focused: React.PropTypes.number
      },
      getDefaultProps: function() {
        return {
          focused: 0
        };
      },
      getInitialState: function() {
        return {
          focused: this.props.focused
        };
      },
      handleClicked: function(index) {
        this.setState({focused: index})
      },
      render: function() {
        var style = ''
        if(this.state.focused == this.props.index){
          style = 'focused';
        };
        // Question: why do I have to bind on handleClicked
        // http://stackoverflow.com/questions/27172358/reactjs-passing-methods-as-props-to-child
        return (
          <span
            className={style}
            onClick={this.handleClicked.bind(null, this.props.index)}>{this.props.item}</span>
        );
      }
    });

      React.render(
        <NavBar navItems={['home', 'about', 'services', 'contact us']} />,
          document.getElementById("content")
      );
    </script>
  </body>
</html>
