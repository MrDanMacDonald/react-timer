<html>
  <head>
    <title>Order Form</title>
    <link type="text/css" rel="stylesheet" href="styles.css"/>
    <script src="http://fb.me/react-0.12.2.js"></script>
    <script src="http://fb.me/JSXTransformer-0.12.2.js"></script>
    <script type="text/javascript" src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
  </head>
  <body>
    <div id="content"></div>
    <script type="text/jsx">
      var FormBox = React.createClass({
        propTypes: {
          orderItems: React.PropTypes.array.isRequired
        },
        getInitialState: function(){
          return {
            subTotal: 0
          };
        },
        handleClicked: function(formItemObj) {
          if(formItemObj.state.selected) {
            this.setState({
              subTotal: this.state.subTotal - formItemObj.props.service.price
            });
          }else{
            this.setState({
              subTotal: this.state.subTotal + formItemObj.props.service.price
            });
          };
        },
        render: function() {
          var formBoxObj = this
          return (
            <div>
              <ul>
                {
                  this.props.orderItems.map(function(item, i){
                    return (
                      <FormItem
                        service={item}
                        onClick={formBoxObj.handleClicked} />
                    );
                  })
                }
              </ul>
              <span>subTotal: {this.state.subTotal}</span>
            </div>
          );
        }
      });

      var FormItem = React.createClass({
        propTypes: {
          service: React.PropTypes.object.isRequired,
          onClick: React.PropTypes.func.isRequired
        },
        getInitialState: function() {
          return {
            selected: false
          };
        },
        handleClicked: function() {
          this.setState({
            selected: true
          });
          this.props.onClick(this);
        },
        render: function() {
          return (
            <li onClick={this.handleClicked}>
              <div>
                {this.props.service.name}
              </div>
              <div>
                {this.props.service.price}
              </div>
            </li>
          );
        }
      });

      var services = [
        { name: 'Web Development', price: 300 },
        { name: 'Design', price: 400 },
        { name: 'Integration', price: 250 },
        { name: 'Training', price: 220 }
      ];

      React.render(
        <FormBox orderItems={services} />,
          document.getElementById("content")
      );
    </script>
  </body>
</html>
